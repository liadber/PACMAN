<!DOCTYPE html>

<html>

<head>
    <title>Pacman - Liad and Amit</title>
    <script type="text/javascript">
        var isLoggedIn=true;
        var user_name;
        function PageLoaded() {
            ShowSection('welcome');
        }
        function ShowSection(id) {
            //hide all sections
            var welcom = document.getElementById('welcome');
            welcom.style.display = "none";
            var signup = document.getElementById('signup');
            signup.style.display = "none";
            var login = document.getElementById('login');
            login.style.display = "none";
            var settings = document.getElementById('settings');
            settings.style.display = "none";
            var game=document.getElementById('game');
            game.style.display="none";


            //show only one section
            var selected = document.getElementById(id);
            selected.style.display = "block";
        }
        window.addEventListener("load", PageLoaded, false);
    </script>
</head>


<body>
    <script type="text/javascript">
        //asked for a user to be existing in array:
        var defultUser= {
            user_name: "a",
            password: "a",
            first_name: "a",
            last_name: "a",
            mail: "a@gmail.com",
            birthday: {
                day: "1",
                month: "2",
                year: "3"
            }
        };
        var users=[defultUser];
        function addToArray(userName,password,firstName,lastName,mail,day, month, year){
            if(checkExistingUserName(userName))
                return false;//cant add- username exist in system
            var birthday= {
                day: day,
                month: month,
                year: year
            };
            var newUser={
                user_name: userName,
                password: password,
                first_name: firstName,
                last_name: lastName,
                mail: mail,
                birthday: birthday
            };
            users.push(newUser);
            return true;
        }
        function search(username, passWord) {
            var length=users.length;
            for(i=0; i<length;i++){
                var user=users[i];
                if(user.user_name==username){
                    if(user.password==passWord){
                        return true;
                    }
                    return false;
                }
            }
            return false;
        }
        function checkExistingUserName(userName){
            var length=users.length;
            for(i=0; i<length;i++){
                var user=users[i];
                if(user.user_name==userName){
                    return true;
                }
            }
            return false;
        }
    </script>

    <div id ="header">
        <div id="menu">


            <style>
                ul {
                    list-style-type: none;
                    margin: 0;
                    padding: 0;
                    overflow: hidden;
                    background-color: #333;
                    position: -webkit-sticky; /* Safari */
                    position: sticky;
                    top: 0;
                }

                li {
                    float: left;
                }

                    li a {
                        display: block;
                        color: white;
                        text-align: center;
                        padding: 14px 16px;
                        text-decoration: none;
                    }

                        li a:hover {
                            background-color: #111;
                        }

                .active {
                    background-color: #4CAF50;
                }
            </style>
            <img position="sticky" height="150" position="center" src="logo.png" alt="logo">

            <br />
            <ul>
                <li><a class="active" onclick="ShowSection('welcome')" href="#" href="#home">Welcome</a></li>
                <li><a onclick="ShowSection('signup')" href="#">Sign Up</a></li>
                <li><a onclick="ShowSection('login')" href="#">Login</a></li>
                <li><a onclick="ShowSection('settings')" href="#">Settings</a></li>
                <li><a id="about">About</a></li>
            </ul>
        </div><!--end menu-->
        </div><!--end�header�-->
        <div id ="content">
            <section id="welcome">
                <table
                        width="100%">
                    <tr><button onclick="ShowSection('signup')" href="#">Sign Up</button></tr>
                    <tr><button onclick="ShowSection('login')" href="#">Login</button></tr>
                </table>
            </section>
            <section id="signup" display="none">
                <style>
                    body {
                        font-family: Arial, Helvetica, sans-serif;
                    }

                    * {
                        box-sizing: border-box
                    }

                    /* Full-width input fields */
                    input[type=text], input[type=password] {
                        width: 100%;
                        padding: 15px;
                        margin: 5px 0 22px 0;
                        display: inline-block;
                        border: none;
                        background: #f1f1f1;
                    }

                        input[type=text]:focus, input[type=password]:focus {
                            background-color: #ddd;
                            outline: none;
                        }

                    hr {
                        border: 1px solid #f1f1f1;
                        margin-bottom: 25px;
                    }

                    /* Set a style for all buttons */
                    button {
                        background-color: #4CAF50;
                        color: white;
                        padding: 14px 20px;
                        margin: 8px 0;
                        border: none;
                        cursor: pointer;
                        width: 100%;
                        opacity: 0.9;
                    }

                        button:hover {
                            opacity: 1;
                        }

                    /* Extra styles for the cancel button */
                    .cancelbtn {
                        padding: 14px 20px;
                        background-color: #f44336;
                    }

                    /* Float cancel and signup buttons and add an equal width */
                    .cancelbtn, .signupbtn {
                        float: left;
                        width: 50%;
                    }

                    /* Add padding to container elements */
                    .container {
                        padding: 16px;
                    }

                    /* Clear floats */
                    .clearfix::after {
                        content: "";
                        clear: both;
                        display: table;
                    }

                    /* Change styles for cancel button and signup button on extra small screens */
                    @media screen and (max-width: 300px) {
                        .cancelbtn, .signupbtn {
                            width: 100%;
                        }
                    }
                </style>
                <form action="/action_page.php" id="signUpForm" style="border:1px solid #ccc">
                    <div class="container">
                        <h1>Sign Up</h1>
                        <p>Please fill in this form to create an account.</p>
                        <hr>
                        <label for="user_name"><b>Password</b></label>
                        <input id="user_name" type="text" placeholder="Enter user name" name="user_name">
                        <br />

                        <label for="pass_w"><b>Password</b></label>
                        <input id="pass_w" type="password" placeholder="Enter Password" name="pass_w">
                        <br />

                        <label for="firstname"><b>First Name</b></label>
                        <input id="firstname" type="text" placeholder="Enter First Name" name="firstname">
                        <br />

                        <label for="lastname"><b>Last Name</b></label>
                        <input id="lastname" type="text" placeholder="Enter Last Name" name="lastname">
                        <br />

                        <label for="email"><b>Email</b></label>
                        <input id="email" type="text" placeholder="Enter Email" name="email">
                        <br />

                        <label for="birthday"><b>Bitrh date</b></label>
                        <input id="birthday" type="date" placeholder="Enter your birth date" name="birthday">
                        <br />
                        <br />



                        <div class="clearfix">
                            <button type="button" class="cancelbtn">Cancel</button>
                            <script type="text/javascript" src="jquery.js"></script>
                            <button type="submit" class="signupbtn" id="signupbtnid" onclick="signup()">Sign Up</button>
                        </div>
                    </div>
                </form>
                <script type="text/javascript">
                    function signup(){
                        var userName=document.getElementById("user_name").value;
                        var password=document.getElementById("pass_w").value;
                        var firstname=document.getElementById("firstname").value;
                        var lastname=document.getElementById("lastname").value;
                        var email=document.getElementById("email").value;
                        var birthday=document.getElementById("birthday").value;
                        var date=birthday.split("-");
                        var day=date[2];
                        var month=date[1];
                        var year=date[0];
                        //todo checks!
                        isSuccess=addToArray(userName,password,firstname,lastname,email,day,month,year);
                        if(!isSuccess){
                            window.alert("user name already exist. Please pick new one and try again");
                        }
                        else{
                            window.alert("User added successfully!");
                        }
                    }
                </script>
                    </section>

            <section id="settings" display="none">
                <h1>Settings:</h1>
                <br />
                <label for="ballNumbe"><b>Number of Balls(minimum:50 maximum:90)</b></label>
                <input id="ballNumbe" placeholder="minimum:50 maximum:90" type="number" name="ballsnum" value="50">
                <br />
                <label for="gameTime"><b>Game Time (minimum:60(sec))</b></label>
                <input id="gameTime" placeholder="Please define game time. minimum:60(sec)" type="number" name="ttlgametime"value="60" />
                <br />
                <label for="monsterNum"><b>Number of monsters(minimum:1 maximum:3</b></label>
                <input id="monsterNum" type="number" name="monsternum"value="1" />
                <br />
                <!--choose color-->
                <script src="jscolor.js"></script>
                <label><b>Choose color for 5 point ball</b></label>
                <input id="firstBall" class="jscolor" value="E6301E">
                <br/>
                <label><b>Choose color for 15 point ball</b></label>
                <input id="secondBall" class="jscolor" value="73E66A">
                <br/>
                <label><b>Choose color for 25 point ball</b></label>
                <input id="thirdBall" class="jscolor" value="5E37E6">

                <button id="random" onclick="randomize()">Click for random balls bumber, time, number of monsters and balls color.</button>
                <br />
                <br />
                <br />
                <br />
                <br />

                <!--choose keys-->

                <label for="upArrowInput"><b>Key for Up</b></label>
                <button id="upArrowInput">Click and Choose Up Key</button>
                <br />

                <label for="downArrowInput"><b>Key for Down</b></label>
                <button id="downArrowInput" >Click and Choose Down Key</button>
                <br />

                <label for="leftArrowInput"><b>Key for Left</b></label>
                <button id="leftArrowInput">Click and Choose Left Key</button>
                <br />

                <label for="rightArrowInput"><b>Key for Right</b></label>
                <button id="rightArrowInput">Click and Choose Right Key</button>
                <br />

                <script>
                    var UP='ArrowUp';
                    var DOWN='ArrowDown';
                    var RIGHT='ArrowRight';
                    var LEFT='ArrowLeft';
                    document.getElementById("upArrowInput").addEventListener("click", function (e) {
                        document.addEventListener("keydown", changeUp);
                        document.getElementById("upArrowInput").innerText="Please press a key now!";
                    }, false);
                    function changeUp(e) {
                        UP=e.code;
                        document.getElementById("upArrowInput").innerText=e.code;
                        // remove this handler
                        document.removeEventListener("keydown",changeUp);
                    }
                    document.getElementById("downArrowInput").addEventListener("click", function (e) {
                        document.addEventListener("keydown", changeDown);
                        document.getElementById("downArrowInput").innerText="Please press a key now!";
                    }, false);
                    function changeDown(e) {
                        DOWN=e.code;
                        document.getElementById("downArrowInput").innerText=e.code;
                        // remove this handler
                        document.removeEventListener("keydown",changeDown);
                    }
                    document.getElementById("leftArrowInput").addEventListener("click", function (e) {
                        document.addEventListener("keydown", changeLeft);
                        document.getElementById("leftArrowInput").innerText="Please press a key now!";
                    }, false);
                    function changeLeft(e) {
                        LEFT=e.code;
                        document.getElementById("leftArrowInput").innerText=e.code;
                        // remove this handler
                        document.removeEventListener("keydown",changeLeft);
                    }
                    document.getElementById("rightArrowInput").addEventListener("click", function (e) {
                        document.addEventListener("keydown", changeRight);
                        document.getElementById("rightArrowInput").innerText="Please press a key now!";
                    }, false);
                    function changeRight(e) {
                        RIGHT=e.code;
                        document.getElementById("rightArrowInput").innerText=e.code;
                        // remove this handler
                        document.removeEventListener("keydown",changeRight);
                    }
                    function getRandomColor() {
                        var letters = '0123456789ABCDEF';
                        var color = '#';
                        for (var i = 0; i < 6; i++) {
                            color += letters[Math.floor(Math.random() * 16)];
                        }
                        return color;
                    }

                    function randomize() {
                        var balls_number=50+Math.floor(Math.random() * 40);
                        var time=60+Math.floor(Math.random()*60);
                        var mon_num=1+Math.floor(Math.random()*3);
                        var first_ball=getRandomColor();
                        var second_ball=getRandomColor();
                        var third_ball=getRandomColor();
                        document.getElementById("ballNumbe").value=balls_number;
                        document.getElementById("gameTime").value=time;
                        document.getElementById("monsterNum").value=mon_num;
                        document.getElementById("firstBall").value=first_ball;
                        document.getElementById("firstBall").jscolor.fromString(first_ball);
                        document.getElementById("secondBall").value=second_ball;
                        document.getElementById("secondBall").jscolor.fromString(second_ball);
                        document.getElementById("thirdBall").value=third_ball;
                        document.getElementById("thirdBall").jscolor.fromString(third_ball);

                    }
                    function Startgame() {
                        if(isLoggedIn)
                            ShowSection("game");
                        else
                            window.alert("please log in before playing the game")
                    }
                </script>
                <!--end choose keys-->
                <br />
                <br />
                <br />
                <br />


                <button id="startgame" onclick="Startgame()">Start !</button>
            </section>

            <section id="aboutSection" display="none">
                <style>
                    /* The Modal (background) */
                    .modal {
                        display: none; /* Hidden by default */
                        position: fixed; /* Stay in place */
                        z-index: 1; /* Sit on top */
                        left: 0;
                        top: 0;
                        width: 100%; /* Full width */
                        height: 100%; /* Full height */
                        overflow: auto; /* Enable scroll if needed */
                        background-color: rgb(0,0,0); /* Fallback color */
                        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
                        -webkit-animation-name: fadeIn; /* Fade in the background */
                        -webkit-animation-duration: 0.4s;
                        animation-name: fadeIn;
                        animation-duration: 0.4s
                    }


                    /* Modal Content */
                    .modal-content {
                        position: fixed;
                        bottom: 0;
                        background-color: #fefefe;
                        width: 100%;
                        -webkit-animation-name: slideIn;
                        -webkit-animation-duration: 0.4s;
                        animation-name: slideIn;
                        animation-duration: 0.4s
                    }

                    /* The Close Button */
                    .close {
                        color: black;
                        float: right;
                        font-size: 28px;
                        font-weight: bold;
                    }
                </style>
                <!-- Trigger/Open The Modal -->
                <!-- The Modal -->
                <div id="myModal" class="modal">

                    <!-- Modal content -->
                    <div class="modal-content">
                        <div class="modal-header">
                            <span class="close">&times;</span>
                            <h2>About</h2>
                        </div>
                        <div class="modal-body">
                            <p>Liad Bercovich 209372887 & Amit Moshe 206408121</p>
                            <p>JQuery usage:</p>
                            <p>Template usage:</p>
                            <p>Difficulties:</p>
                        </div>
                        <div class="modal-footer">
                            <h3>Modal Footer</h3>
                        </div>
                    </div>

                    <script>
                        // Get the modal
                        var modal = document.getElementById('myModal');

                        // Get the button that opens the modal
                        var btn = document.getElementById("about");

                        // Get the <span> element that closes the modal
                        var span = document.getElementsByClassName("close")[0];

                        // When the user clicks the button, open the modal
                        btn.onclick = function () {
                            modal.style.display = "block";
                        }

                        // When the user clicks on <span> (x), close the modal
                        span.onclick = function () {
                            modal.style.display = "none";
                        }

                        // When the user clicks anywhere outside of the modal, close it
                        window.onclick = function (event) {
                            if (event.target == modal) {
                                modal.style.display = "none";
                            }
                            else{
                                event.preventDefault();
                            }
                        }

                    </script>

                </div>

            </section>
            <section id="login" display="none">
                <form action="/action_page.php" id="loginForm" style="border:1px solid #ccc">
                    <div class="container">
                        <h1>Log In</h1>
                        <p>Please sign in to get access to the Pacman game.</p>
                        <hr>

                        <label for="username"><b>User Name</b></label>
                        <input id="username" type="text" placeholder="Enter User Name" name="username">
                        <br />

                        <label for="psw"><b>Password</b></label>
                        <input id="psw" type="password" placeholder="Enter Password" name="psw">
                        <br />

                        <div class="clearfix">
                            <script type="text/javascript" src="jquery.js"></script>
                            <button type="submit" class="signinbtn" id="signinbtnid" onclick="loginUser()">Sign In</button>
                        </div>
                    </div>
                </form>
                <script type="text/javascript">
                function loginUser(){
                    var userName=document.getElementById("username").value;
                    var password=document.getElementById("psw").value;
                    isSuccess=search(userName,password);
                    if(!isSuccess){
                        window.alert("User name or password are incorrect. Please try again.")
                    }
                    else{
                        //todo open the game
                        ShowSection("settings");
                        //window.alert("You may play the game now!")
                        isLoggedIn=true;
                        user_name=userName;
                    }
                }
                </script>
            </section>
            <section id="game" display="none">
                    <button id="start" onclick="Start()">Start</button>
                    Score:
                    <input id="lblScore" type="text" />
                    <br />
                    Time:
                    <input id="lblTime" type="text" />
                    <br />
                    Life:
                    <input id="lblLife" type="text" />
                    <br />
                    <canvas id="canvas" height="600" width="600"></canvas>
                    <script type="text/javascript">
                    var context = canvas.getContext("2d");
                    var shape = new Object();
                    var board;
                    var score;
                    var pac_color;
                    var start_time;
                    var time_elapsed;
                    var interval;
                    var _maxTime;
                    var _ballsNumb;
                    var is_time_over=false;
                    var packman_last_move="right"
                    var num_life=3;
                    var location_monster1=[9,0];
                    var location_monster2=[9,9];
                    var location_monster3=[0,9];
                    var num_of_first_balls;
                    var num_of_second_balls;
                    var num_of_third_balls;
                    var ball_eaten_monster1=0;
                    var ball_eaten_monster2=0;
                    var ball_eaten_monster3=0;
                    var start_monsters_movement=false;
                    //defnition to the numbers on the board:
                    //0 nothing
                    //11- 5 point 60%
                    //12- 15 points 30%
                    //13- 25 points 10%
                    //2- pacman
                    //4- walls
                    //50,60,70- monsters that on places without food;
                    //51,61,71- monsters that on places with food;

                    function SettingIsValid() {
                        if(!isLoggedIn){
                            window.alert("Please log in before you play a game!.")
                            return false;
                        }
                        if (ballNumbe.value < 50 || ballNumbe.value > 90) {
                            window.alert("Please define a balls number minimum 50  or maximum 90.")
                            return false;
                        }
                        if (document.getElementById("monsterNum").value < 1 || document.getElementById("monsterNum").value > 3) {
                            window.alert("Please define number of monsters between 1-3.")
                            return false;
                        }
                        if (gameTime.value < 60) {
                            window.alert("Please define a game time at least 60 seconds.");
                            return false;
                        }
                        return true;
                    }
                    function addFood(i, j) {
                        var random = Math.random();
                        if (random <= 0.6 && num_of_first_balls > 0) {
                            num_of_first_balls -= 1;
                            board[i][j] = 11;
                        }
                        else if (random <= 0.6)//no 5 point ball left:50-50 per to what food
                        {
                            if (random <= 0.3 && num_of_second_balls > 0) {
                                num_of_second_balls -= 1;
                                board[i][j] = 12;
                            }
                            else if (random < 0.3)//no second remain
                            {
                                num_of_third_balls -= 1;
                                board[i][j] = 13;
                            }
                            else {//random>=0.3-try third 25 points
                                if (num_of_third_balls > 0) {
                                    num_of_third_balls -= 1;
                                    board[i][j] = 13;
                                }
                                else {//only 15 left
                                    num_of_second_balls -= 1;
                                    board[i][j] = 12;
                                }
                            }
                        }
                        else if (random <= 0.9 && num_of_second_balls > 0)//try add the 2nd - 0.6<=random<=0.9
                        {
                            num_of_second_balls -= 1;
                            board[i][j] = 12;
                        }
                        else if (random <= 0.9)// 0.6<=random<=0.9- middle 0.75 no 15 points left
                        {
                            if (random <= 0.75 && num_of_first_balls > 0) {
                                num_of_first_balls -= 1;
                                board[i][j] = 11;
                            }
                            else if (random < 0.75)//no first remain
                            {
                                num_of_third_balls -= 1;
                                board[i][j] = 13;
                            }
                            else {//random>=0.75-try third 25 points
                                if (num_of_third_balls > 0) {
                                    num_of_third_balls -= 1;
                                    board[i][j] = 13;
                                }
                                else {//only third left
                                    num_of_first_balls -= 1;
                                    board[i][j] = 11;
                                }
                            }
                        }
                        else {//random>=0.9 - try add the 25 points
                            if (num_of_third_balls > 0) {
                                num_of_third_balls -= 1;
                                board[i][j] = 13;
                            }
                            else {//no third left
                                if (random <= 0.95 && num_of_first_balls > 0) {
                                    num_of_first_balls -= 1;
                                    board[i][j] = 11;
                                }
                                else if (random <= 0.95)//no first remain
                                {
                                    num_of_second_balls -= 1;
                                    board[i][j] = 12;
                                }
                                else {//random>=0.95-try second 15 points
                                    if (num_of_third_balls > 0) {
                                        num_of_second_balls -= 1;
                                        board[i][j] = 12;
                                    }
                                    else {//only second left
                                        num_of_first_balls -= 1;
                                        board[i][j] = 11;
                                    }
                                }
                            }
                        }
                    }
                    function Start() {

                        if (SettingIsValid()) {
                            _ballsNumb = document.getElementById("ballNumbe").value;
                            _maxTime = document.getElementById("gameTime").value;
                            board = new Array();
                            score = 0;
                            num_life=3;
                            is_time_over=false;
                            pac_color = "yellow";
                            var cnt = 100;

                            var food_remain = ballNumbe.value;
                            num_of_first_balls=Math.abs(ballNumbe.value*0.6);
                            num_of_second_balls=Math.abs(ballNumbe.value*0.3);
                            num_of_third_balls=Math.abs(ballNumbe.value-num_of_first_balls-num_of_second_balls);
                            var pacman_remain = 1;
                            start_time = new Date();
                            for (var i = 0; i < 10; i++) {
                                board[i] = new Array();
                                //put obstacles in (i=3,j=3) and (i=3,j=4) and (i=3,j=5), (i=6,j=1) and (i=6,j=2)
                                for (var j = 0; j < 10; j++) {
                                    if ((i === 3 && j === 3) || (i === 3 && j === 4) || (i === 3 && j === 5) || (i === 6 && j === 1) || (i === 6 && j === 2)) {
                                        board[i][j] = 4;
                                    }
                                     else if ((i === location_monster1[0] && j === location_monster1[1])) {
                                        board[i][j] = 50;
                                    }else if ((i === location_monster2[0] && j === location_monster2[1])&&document.getElementById("monsterNum").value>1) {
                                        board[i][j] = 60;
                                    }else if ((i === location_monster3[0] && j === location_monster3[1])&&document.getElementById("monsterNum").value>2) {
                                        board[i][j] = 70;
                                    }else {
                                        var randomNum = Math.random();
                                        if (randomNum <= 1.0 * food_remain / cnt) {//add random food
                                            addFood(i,j);

                                            food_remain--;
                                        } else if (randomNum < 1.0 * (pacman_remain + food_remain) / cnt) {
                                            shape.i = i;
                                            shape.j = j;
                                            pacman_remain--;
                                            board[i][j] = 2;
                                        } else {
                                            board[i][j] = 0;
                                        }
                                        cnt--;
                                    }
                                }
                            }
                            while (food_remain > 0) {
                                var emptyCell = findRandomEmptyCell(board);
                                addFood(emptyCell[0],emptyCell[1])
                                food_remain--;
                            }
                            keysDown = {};
                            addEventListener("keydown", function (e) {
                                keysDown[e.code] = true;
                            }, false);
                            addEventListener("keyup", function (e) {
                                keysDown[e.code] = false;
                            }, false);
                            interval = setInterval(UpdatePosition, 170);

                        }//\if setting is valid
                    }                   
                    function findRandomEmptyCell(board) {
                        var i = Math.floor((Math.random() * 9) + 1);
                        var j = Math.floor((Math.random() * 9) + 1);
                        while (board[i][j] !== 0) {
                            i = Math.floor((Math.random() * 9) + 1);
                            j = Math.floor((Math.random() * 9) + 1);
                        }
                        return [i, j];
                    }
                    /**
                     * @return {number}
                     */
                    function GetKeyPressed() {
                        if (keysDown[UP]) {
                            return 1;
                        }
                        if (keysDown[DOWN]) {
                            return 2;
                        }
                        if (keysDown[LEFT]) {
                            return 3;
                        }
                        if (keysDown[RIGHT]) {
                            return 4;
                        }
                    }

                    function Draw() {
                        context.clearRect(0, 0, canvas.width, canvas.height); //clean board
                        lblScore.value = score;
                        lblTime.value = time_elapsed;
                        lblLife.value=num_life;
                        //draw the user name on canvas
                        gradient = context.createLinearGradient(0, 0, canvas.width, 0);
                        gradient.addColorStop("0", "red");
                        gradient.addColorStop(".25", "yellow");
                        gradient.addColorStop(".50", "green");
                        gradient.addColorStop(".75", "blue");
                        gradient.addColorStop("1.0", "magenta");
                        context.font = "italic 700 30px Unknown Font, sans-serif";
                        context.fillStyle = gradient;
                        context.fillText(user_name+" good luck!", 20, 20, 100);

                        for (var i = 0; i < 10; i++) {
                            for (var j = 0; j < 10; j++) {
                                var center = new Object();
                                center.x = i * 60 + 30;
                                center.y = j * 60 + 30;
                                if (board[i][j] === 2) {
                                    var big_first=0.15 ;
                                    var big_second=1.85 ;
                                    var eye_x=5;
                                    var eye_y=-15;
                                    if(packman_last_move!="right"){
                                        if(packman_last_move=="left"){
                                            big_first=1.15
                                            big_second=0.85
                                            eye_x=-5;
                                            eye_y=-15;
                                        }
                                        else if(packman_last_move=="up"){
                                            big_first=1.65
                                            big_second=1.35
                                            eye_x=-15;
                                            eye_y=-10;
                                        }
                                        else{//down
                                            big_first=0.65
                                            big_second=0.35
                                            eye_x=15;
                                            eye_y=10;
                                        }
                                    }
                                    context.beginPath();
                                    context.arc(center.x, center.y, 30, big_first* Math.PI,big_second* Math.PI ); // half circle
                                    context.lineTo(center.x, center.y);
                                    context.fillStyle = pac_color; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x + eye_x, center.y +eye_y, 5, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                } else if (board[i][j] === 11||board[i][j]===12||board[i][j]===13) {
                                    var color="black";
                                    var size=15;
                                    if(board[i][j]===11){
                                        color=document.getElementById("firstBall").value;
                                        size=15;
                                    }
                                    else if(board[i][j]===12){
                                        color=document.getElementById("secondBall").value;
                                        size=20;
                                    }
                                    else{//===13
                                        color=document.getElementById("thirdBall").value;
                                        size=25;
                                    }
                                    color="#"+color;
                                    context.beginPath();
                                    context.arc(center.x, center.y, size, 0, 2 * Math.PI); // circle
                                    context.fillStyle = color; //color
                                    context.fill();
                                } else if (board[i][j] === 4) {
                                    context.beginPath();
                                    context.rect(center.x - 30, center.y - 30, 60, 60);
                                    context.fillStyle = "grey"; //color
                                    context.fill();
                                } else if(board[i][j] === 50||board[i][j]===51)  {//first monster
                                    if(start_monsters_movement){
                                        print("here")
                                    }
                                    context.beginPath();
                                    context.arc(center.x , center.y , 30, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "red"; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x + 10, center.y -15, 5, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x - 10, center.y -15, 5, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x , center.y +10, 10, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                }
                                else if(board[i][j]===60||board[i][j]===61){//second monster
                                    context.beginPath();
                                    context.arc(center.x , center.y , 30, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "blue"; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x + 10, center.y -15, 5, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x - 10, center.y -15, 5, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x , center.y +10, 10, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                }
                                else if(board[i][j]===70||board[i][j]===71){//third monster
                                    context.beginPath();
                                    context.arc(center.x , center.y , 30, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "green"; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x + 10, center.y -15, 5, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x - 10, center.y -15, 5, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                    context.beginPath();
                                    context.arc(center.x , center.y +10, 10, 0, 2 * Math.PI); // circle
                                    context.fillStyle = "black"; //color
                                    context.fill();
                                }
                            }
                        }
                    }
                    function moveMonster_1(){
                        var new_i=location_monster1[0]
                        var new_j=location_monster1[1]
                        if(new_i<shape.i)//try move right
                        {
                            if(!tryRight(new_i,new_j,1)){//cant move right
                                if(new_j<shape.j){//try move down
                                    if(!tryDown(new_i,new_j)){//cant move down
                                        if(!tryUp(new_i,new_j,1)){//cant move up also- only left do left- will sure succeed
                                            tryLeft(new_i,new_j,1);
                                            return;
                                        }
                                    }
                                }
                                else{//try move up
                                    if(!tryUp(new_i,new_j,1)){//cant move up
                                        if(!tryDown(new_i,new_j,1)){//cant move down also- only left do left- will sure succeed
                                            tryLeft(new_i,new_j,1);
                                            return;
                                        }
                                    }
                                }
                            }
                        }
                        else if(new_i>shape.i)//try move left
                        {
                            if(!tryLeft(new_i,new_j,1)){//cant move left
                                if(new_j<shape.j){//try move down
                                    if(!tryDown(new_i,new_j,1)){//cant move down
                                        if(!tryUp(new_i,new_j,1)){//cant move up also- only left do right- will sure succeed
                                            tryRight(new_i,new_j,1);
                                        }
                                    }
                                }
                                else{//try move up
                                    if(!tryUp(new_i,new_j,1)){//cant move up
                                        if(!tryDown(new_i,new_j,1)){//cant move down also- only left do right- will sure succeed
                                            tryRight(new_i,new_j,1);
                                            return;
                                        }
                                    }
                                }
                            }
                        }
                        else{//in the same col as packman
                            if(new_j<shape.j){//try move down
                                if(!tryDown(new_i,new_j,1)){//cant move down
                                    if(!tryRight(new_i,new_j,1)){//cant move right
                                        if(!tryLeft(new_i,new_j,1)){//try left and if not go the opposite direction
                                            tryUp(new_i,new_j,1);
                                            return;
                                        }

                                    }
                                }
                            }
                            else{//try move up
                                if(!tryUp(new_i,new_j,1)){//cant move up
                                    if(!tryRight(new_i,new_j,1)){//cant move down
                                        if(!tryLeft(new_i,new_j,1)) {
                                            tryDown(new_i,new_j,1);
                                            return;
                                        }
                                    }
                                }
                            }
                        }
                    }//move monsters

                    function tryUp(i,j,monsterNum){
                        if(board[i][j-1]!=4){//no wall can go up
                            j=j-1;
                            if(monsterNum===1){//monster number 1
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster1=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster1==12;
                                    }
                                    else{
                                        ball_eaten_monster1==13;
                                    }
                                    board[i][j]=51;
                                }
                                else{//there is no food
                                    board[j][j]=50;
                                }
                                //prev position
                                if(board[i][j+1]===51){//there was food
                                    board[i][j+1]=ball_eaten_monster1;
                                }
                                else{//there wasnt food
                                    board[i][j+1]=0;
                                }
                                location_monster1=[i,j]
                            }
                            else if(monsterNum===2)//monster 2
                            {
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster2=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster2==12;
                                    }
                                    else{
                                        ball_eaten_monster2==13;
                                    }
                                    board[i][j]=61;
                                }
                                else{//there is no food
                                    board[j][j]=60;
                                }
                                //prev position
                                if(board[i][j+1]===61){//there was food
                                    board[i][j+1]=ball_eaten_monster2;
                                }
                                else{//there wasnt food
                                    board[i][j+1]=0;
                                }
                                location_monster2=[i, j]

                            }
                            else if(monsterNum===3)//monster 3
                            {
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster3=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster3==12;
                                    }
                                    else{
                                        ball_eaten_monster3==13;
                                    }
                                    board[i][j]=71;
                                }
                                else{//there is no food
                                    board[j][j]=70;
                                }
                                //prev position
                                if(board[i][j+1]===71){//there was food
                                    board[i][j+1]=ball_eaten_monster3;
                                }
                                else{//there wasnt food
                                    board[i][j+1]=0;
                                }
                                location_monster3=[i,j]

                            }
                            return true;
                        }
                        else{
                            return false;
                        }
                    }

                    function tryDown(i,j,monsterNum){
                        if(board[i][j+1]!=4){//no wall can go up
                            j=j+1;
                            if(monsterNum===1){//monster number 1
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster1=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster1==12;
                                    }
                                    else{
                                        ball_eaten_monster1==13;
                                    }
                                    board[i][j]=51;
                                }
                                else{//there is no food
                                    board[j][j]=50;
                                }
                                //prev position
                                if(board[i][j-1]===51){//there was food
                                    board[i][j-1]=ball_eaten_monster1;
                                }
                                else{//there wasnt food
                                    board[i][j-1]=0;
                                }
                                location_monster1=[i,j]

                            }
                            else if(monsterNum===2)//monster 2
                            {
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster2=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster2==12;
                                    }
                                    else{
                                        ball_eaten_monster2==13;
                                    }
                                    board[i][j]=61;
                                }
                                else{//there is no food
                                    board[j][j]=60;
                                }
                                //prev position
                                if(board[i][j-1]===61){//there was food
                                    board[i][j-1]=ball_eaten_monster2;
                                }
                                else{//there wasnt food
                                    board[i][j-1]=0;
                                }
                                location_monster2=[i,j]

                            }
                            else if(monsterNum===3)//monster 3
                            {
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster3=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster3==12;
                                    }
                                    else{
                                        ball_eaten_monster3==13;
                                    }
                                    board[i][j]=71;
                                }
                                else{//there is no food
                                    board[j][j]=70;
                                }
                                //prev position
                                if(board[i][j-1]===71){//there was food
                                    board[i][j-1]=ball_eaten_monster3;
                                }
                                else{//there wasnt food
                                    board[i][j-1]=0;
                                }
                                location_monster3=[i,j]

                            }
                            return true;
                        }
                        else{
                            return false;
                        }
                    }

                    function tryRight(i,j,monsterNum){
                        if(board[i+1][j]!=4){//no wall can go up
                            i=i+1;
                            if(monsterNum===1){//monster number 1
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster1=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster1==12;
                                    }
                                    else{
                                        ball_eaten_monster1==13;
                                    }
                                    board[i][j]=51;
                                }
                                else{//there is no food
                                    board[j][j]=50;
                                }
                                //prev position
                                if(board[i-1][j]===51){//there was food
                                    board[i-1][j]=ball_eaten_monster1;
                                }
                                else{//there wasnt food
                                    board[i-1][j]=0;
                                }
                                location_monster1=[i,j]
                            }
                            else if(monsterNum===2)//monster 2
                            {
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster2=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster2==12;
                                    }
                                    else{
                                        ball_eaten_monster2==13;
                                    }
                                    board[i][j]=61;
                                }
                                else{//there is no food
                                    board[j][j]=60;
                                }
                                //prev position
                                if(board[i-1][j]===61){//there was food
                                    board[i-1][j]=ball_eaten_monster2;
                                }
                                else{//there wasnt food
                                    board[i-1][j]=0;
                                }
                                location_monster2=[i,j]

                            }
                            else if(monsterNum===3)//monster 3
                            {
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster3=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster3==12;
                                    }
                                    else{
                                        ball_eaten_monster3==13;
                                    }
                                    board[i][j]=71;
                                }
                                else{//there is no food
                                    board[j][j]=70;
                                }
                                //prev position
                                if(board[i-1][j]===71){//there was food
                                    board[i-1][j]=ball_eaten_monster3;
                                }
                                else{//there wasnt food
                                    board[i-1][j]=0;
                                }
                                location_monster3=[i,j]

                            }
                            return true;
                        }
                        else{
                            return false;
                        }
                    }

                    function tryLeft(i,j,monsterNum){
                        if(board[i-1][j]!=4){//no wall can go up
                            i=i-1;
                            
                            if(monsterNum===1){//monster number 1
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster1=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster1==12;
                                    }
                                    else{
                                        ball_eaten_monster1==13;
                                    }
                                    board[i][j]=51;
                                }
                                else{//there is no food
                                    board[j][j]=50;
                                }
                                //prev position
                                if(board[i+1][j]===51){//there was food
                                    board[i+1][j]=ball_eaten_monster1;
                                }
                                else{//there wasnt food
                                    board[i+1][j]=0;
                                }
                                location_monster1=[i,j]

                            }
                            else if(monsterNum===2)//monster 2
                            {
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster2=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster2==12;
                                    }
                                    else{
                                        ball_eaten_monster2==13;
                                    }
                                    board[i][j]=61;
                                }
                                else{//there is no food
                                    board[j][j]=60;
                                }
                                //prev position
                                if(board[i+1][j]===61){//there was food
                                    board[i+1][j]=ball_eaten_monster2;
                                }
                                else{//there wasnt food
                                    board[i+1][j]=0;
                                }
                                location_monster2=[i,j]

                            }
                            else if(monsterNum===3)//monster 3
                            {
                                //next position
                                if(board[i][j]===11||board[i][j]===12||board[i][j]===13){//there is food
                                    if(board[i][j]===11){
                                        ball_eaten_monster3=11;
                                    }
                                    else if(board[i][j]===12){
                                        ball_eaten_monster3==12;
                                    }
                                    else{
                                        ball_eaten_monster3==13;
                                    }
                                    board[i][j]=71;
                                }
                                else{//there is no food
                                    board[j][j]=70;
                                }
                                //prev position
                                if(board[i+1][j]===71){//there was food
                                    board[i+1][j]=ball_eaten_monster3;
                                }
                                else{//there wasnt food
                                    board[i+1][j]=0;
                                }
                                location_monster3=[i,j]

                            }
                            return true;
                        }
                        else{
                            return false;
                        }
                    }


                    function is_eaten() {
                        board[shape.i][shape.j]===50||board[shape.i][shape.j]===60||board[shape.i][shape.j]===70||
                        board[shape.i][shape.j]===51||board[shape.i][shape.j]===61||board[shape.i][shape.j]===71
                        //todo
                        //!!!!
                    }
                    function UpdatePosition() {
                        if(board[shape.i][shape.j]!=50&&board[shape.i][shape.j]!=60&&board[shape.i][shape.j]!=70
                        &&board[shape.i][shape.j]!=51&&board[shape.i][shape.j]!=61&&board[shape.i][shape.j]!=71)
                            board[shape.i][shape.j] = 0;
                        var x = GetKeyPressed();
                        if (x === 1) {
                            if (shape.j > 0 && board[shape.i][shape.j - 1] !== 4) {
                                shape.j--;
                                packman_last_move="up";
                                start_monsters_movement=true;
                            }
                        }
                        if (x === 2) {
                            if (shape.j < 9 && board[shape.i][shape.j + 1] !== 4) {
                                shape.j++;
                                packman_last_move="down";
                                start_monsters_movement=true;
                            }
                        }
                        if (x === 3) {
                            if (shape.i > 0 && board[shape.i - 1][shape.j] !== 4) {
                                shape.i--;
                                packman_last_move="left";
                                start_monsters_movement=true;
                            }
                        }
                        if (x === 4) {
                            if (shape.i < 9 && board[shape.i + 1][shape.j] !== 4) {
                                shape.i++;
                                packman_last_move="right";
                                start_monsters_movement=true;
                            }
                        }
                        if (board[shape.i][shape.j] === 11||board[shape.i][shape.j] === 12||board[shape.i][shape.j] === 13) {
                            if(board[shape.i][shape.j] === 11){
                                score+=5;
                            }
                            else if(board[shape.i][shape.j] === 12){
                                score+=15;
                            }
                            else{
                                score+=25;
                            }
                        }
                        if(is_eaten() ){//loss
                            num_life-=1;
                            if(score>=20)
                                score-=20;
                            else
                                score=0;

                            location_monster1=[9,0];
                            location_monster2=[9,9];
                            location_monster3=[0,9];
                            start();
                            return;

                        }
                        board[shape.i][shape.j] = 2;
                        var currentTime = new Date();
                        time_elapsed = (currentTime - start_time) / 1000;
                        if (score >= 20 && time_elapsed <= 10) {
                            pac_color = "green";
                        }
                        if(num_life===0){
                            window.clearInterval(interval);
                            window.alert("You Lost!");
                        }
                        else if (time_elapsed > _maxTime&&!is_time_over){
                            if(score<150) {
                                window.clearInterval(interval);
                                window.alert("You can do better");
                            }
                            else {
                                window.clearInterval(interval);
                                window.alert("We have a Winner!!!");
                            }
                            is_time_over=true;
                        } else if(!is_time_over){
                            if(start_monsters_movement)
                                moveMonster_1()
                            Draw();
                        }
                    }
                    </script>
            </section>

            <div id ="footer">
                </div>    <!-- end�footer-->
                </div ><!-- end�content-->
            </body>
</html>
                    